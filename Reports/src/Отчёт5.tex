\documentclass[a4paper,12pt]{article}

\usepackage[hidelinks]{hyperref}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{shorttoc}
\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{float}
\graphicspath{{./images/}}

\definecolor{linkcolor}{HTML}{000000}
\definecolor{urlcolor}{HTML}{0085FF}
\hypersetup{pdfstartview=FitH,  linkcolor=linkcolor,urlcolor=urlcolor, colorlinks=true}

\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}

\renewcommand*\contentsname{Содержание}

\newcommand{\plot}[3]{
    \begin{figure}[H]
        \includegraphics[scale=0.7]{#1}
        \caption{#2}
        \label{#3}
    \end{figure}
}

\begin{document}
    \include{Title.tex}
    \newpage

    \tableofcontents
    \newpage

    \section{Постановка задачи}
    Задать набор входных точечных переменных $ x $ и выходных интервальных переменных $ \textbf{y} $ c зависимостью близкой к линейной. \newline
    Провести вычисления и привести иллюстрации:
    \begin{itemize}
        \item Построить интервальное множество решений $ \beta $, сделать точечные оценки параметров.
        \item Построить коридор совместных зависимостей
        \item Задать набор точек предсказания внутри в вне $ x $, построить набор значений выходной переменной $ \textbf{y} $
    \end{itemize}

    \section{Теория}
    Пусть величина $ y $ является функцией от независимых аргументов $ x_{1}, ..., x_{m} $.
    \begin{equation}
        y = f(x, \beta)
        \label{eq:generaltask}
    \end{equation}
    где $ x = (x_{1}, ..., x_{m}) $ - вектор независимых переменных, 
    $ \beta = (\beta_{1}, ..., \beta{l}) $ - вектор параметров функции. \newline
    Имея набор значений $ x $ и $ y $, нужно найти вектор $ \beta $, который соответствует конкретной функции из семейства \ref{eq:generaltask}.
    Эта задача называется задачей восстановления зависимости.\newline

    \noindent
    Будем рассматривать задачу, в которой $ x $ - точечный вектор, а $ y $ - интервальный вектор.
    Информационным множеством задачи восстановления зависимости называется множество значений параметров зависимости, совместных с данными.
    Для случая линейной зависимости информационное множество - это выпуклое множество, ограниченное гиперплоспостями в пространстве $ R^{n} $ \newline
    Коридором совместных зависимостей называется многозначное отображение $ \Upsilon $, которое сопоставляет каждому значению аргумента $ x $ множество
    \begin{equation}
         \Upsilon(x) = \bigcup_{\beta \in \Omega}f(x, \beta)
    \end{equation}
    где $ y = f(x, \beta) $ - зависимость из задачи восстановления зависимости, $ \Omega $ - непустое информационное множество параметров.
    
    \subsection{Точечная оценка параметров регрессии}
    Пусть модель задаётся в классе линейных функций $ y = \beta_{0} + \beta_{1}x $
    Для нахождения точечной оценки параметров регрессии поставим задачу линейной оптимизации и решим её:
    \begin{gather}
        \sum_{i = 1}^{m}w_{i} \to min \\
        \text{mid}\textbf{y}_{i} - w_{i} \cdot \text{rad}\textbf{y}_{i} \leq X\beta \leq \text{mid}\textbf{y}_{i} + w_{i} \cdot \text{rad}\textbf{y}_{i} \\
        w_{i} \geq 0, i = 1, ..., m \\
        w, \beta - ?
    \end{gather}
    где $ m $ - число входных значений, $ X $ - матрица линейной регрессии, $ w $ - вектор весов. \newline

    \noindent
    Другие варианты точечной оценки параметров регрессии: \newline
    Середина наибольшей диагонали информационного множества:
    \begin{equation}
        \beta = \frac{(b_{1} + b_{2})}{2}
    \end{equation}
    где $ b_{1}, b_{2} $ - вершины информационного множества, находящиеся на максимальном расстоянии друг от друга.\newline

    \noindent
    Центр тяжести информационного множества:
    \begin{equation}
        \beta = \text{mean}V
    \end{equation}
    где $ V $ - множество вершин информационного множества.
    
    \section{Реализация}
    Язык программирования: Python. Среда разработки: Visual Studio Code.
    \href{https://github.com/kirillkuks/IntervalAnalysis/tree/master/Lab5}{Ссылка на GitHub}.

    \section{Результаты}
    \subsection{Генерация данных}
    Рассматривается модель $ y = kx + b $. Для заданного набора значений входных значений $ x $ считается точечный вектор выходных значений $ y $.
    Затем строится интервальный вектор выходных значений следующим образом: точечное значение $ y_{j} $ заменяется интервалом $ [y_{j} - |\delta_{1}|, y_{j} + |\delta_{2}|] $ ($ j = 1, ..., m $),
    где $ \delta_{1}, \delta_{2} $ - случайные величины, $ \delta_{1}, \delta_{2} \in N(0, 5) $.
    
    \subsection{Результаты}
    Параметры модели: $ k = 1, b = 0 $, набор входных значений $ x = (1.0, 2.0, ..., 25.0) $.
    График $ y = kx + b $ модели и исходная выбока:
    \plot{Model}{Исходная выборка}{p:model}

    \noindent
    Будем решать задачу восстановления зависимости для класса функций $ y = \beta_{0} + \beta_{1}x $.
    Построим информационное множество и точечные оценки параметров зависимости.
    \plot{InformationSet}{Интервальная оценка параметров зависимости}{p:informset}

    \noindent
    Графики функций с полученными точечными оценками параметров $ \beta_{0}, \beta_{1} $ будут иметь следующий вид:
    \plot{BuildedModels}{Графики функций с точечными оценками параметров зависимости}{p:buildedmodels}

    \noindent
    Теперь построим коридор совместных зависимостей.
    \plot{CorridorOfSharedDependencies}{Коридор совместных зависимостей}{p:corridor}

    \noindent
    Зададим набор точек предсказания внутри и вне $ x $ и построим набор выходных значений $ \textbf{y} $. \newline
    Набор внутри $ x $: $ x_{1} = (5.5, ..., 14.5) $.
    \plot{Predict5.5-14.5}{Значения выходной переменной $ \textbf{y} $ для точек предсказания внутри $ x $}{p:predictinner}

    \noindent
    Набор вне $ x $: $ x_{2} = (50, ..., 59) $.
    \plot{Predict50-59}{Значения выходной переменной $ \textbf{y} $ для точек предсказания вне $ x $}{p:predictouter}

    \noindent
    Набор $ x_{3} = (0.0, 0.5, ..., 59, 59.5) $.
    \plot{Predict0.0-59.5}{Значения выходной переменной $ \textbf{y} $ для большого набора точек предсказания}{p:predictgeneral}

    \section{Обсуждения}
    На рисунке \ref{p:informset} видно, что построенное информационное множество содержит истинные значения параметров $ \beta_{0}, \beta_{1} (\beta_{0} = 0, \beta_{1} = 1) $.
    А лучшую точечную оценку параметов зависимости в этом случае даёт центр тяжести. Также стоит отметить, что точечная регрессия попала в информационное множество.
    На рисунке \ref{p:buildedmodels} более наглядно видно, что построенные точечные оценки близки к исходной модели. \newline
    Постоенный коридор совместных зависимостей содержит исходую модель, что видно на рисунке \ref{p:corridor}.
    Коридор совместных зависимостей имеет непостоянную ширину, наименьшую неопределённость построенная модель имеет в центре исходной выборки, 
    а при приближении к концам неопределённость выходных значений возрастает. \newline
    Тоже самое наблюдается на рисунках \ref{p:predictinner} - \ref{p:predictouter}, для набора значений предсказания внутри $ x $ неопределённость выходных значений $ \textbf{y} $ значительно меньше, 
    чем при значениях предсказания вне $ x $. Также стоит отметить, что для обоих наборов предсказания полученные интервальные выходные значения $ \textbf{y} $ содеражат исходную модель.
    На рисунке $ \ref{p:predictgeneral} $ представлена общая картина для наборов предсказания внутри и вне $ x $.

\end{document}
